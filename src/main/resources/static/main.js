$((function(){var e=[],t=[];function a(e){var t=[];return $.ajax({type:"GET",url:host+"/item/get",data:{id:e},async:!1,xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?t=e.data:alert("获取商品信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品信息失败，原因是"+e.responseText)}}),t}$.ajax({type:"GET",url:host+"/address/list",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(t=e.data,function(){if(null==t)$("#address_list").append("<dd>请编辑收货地址</dd>");else for(var e=0;e<t.length;e++){var a="",r=t[e];a+='<dd><input type="radio" name="address" value="'+r.id+'"',1==r.status&&(a+=" checked "),a+=">"+r.address+" （"+r.addresseeName+" 收） "+r.encrptTelphone+"</dd>",$("#address_list").append(a)}}()):(alert("加载地址信息失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("加载地址信息失败，原因是"+e.responseText)}});var r,s,n=(r=new RegExp("(^|&)id-build=([^&]*)(&|$)"),null!=(s=window.location.search.substr(1).match(r))?decodeURI(s[2]):null);$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/order/createfromcart",data:{id:n},xhrFields:{withCredentials:!0},success:function(t){"success"==t.status?(e=t.data,function(){var t=0,r=0;if(null!=e){for(var s=0;s<e.length;s++){var n=s+1,i="",l=a(e[s].itemId);t+=e[s].amount,r+=e[s].orderPrice,i+='<ul class="goods_list_td clearfix">\n                <li class="col01">'+n+'</li>\n                <li class="col02"><img src="'+l.imgUrl+'"></li>\n                <li class="col03">'+l.title+'</li>\n                <li class="col04">一件</li>\n                <li class="col05">'+l.price+'</li>\n                <li class="col06">'+e[s].amount+'</li>\n                <li class="col07">'+e[s].orderPrice+"</li>\t\n           </ul>",$("#order_list").append(i)}$("#amount").html(t),$(".total").html(r.toFixed(2)+"元"),$("#order_btn").on("click",(function(){for(var t=!1,a=$('input[name="pay_style"]:checked').val(),r=$('input[name="address"]:checked').val(),s=0;s<e.length;s++)$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/order/complete",data:{id:e[s].id,paymentMethod:a,addressId:r},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status||(t=!0,alert("提交订单失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){t=!0,alert("提交订单失败，原因是"+e.responseText)}});0==t&&(window.location.href="user_center_order.html")}))}}()):(alert("加载订单信息失败，原因是"+t.data.errMsg),20003==t.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("加载订单信息失败，原因是"+e.responseText)}})})),$((function(){function e(e){var t=[];return $.ajax({type:"GET",url:host+"/item/get",data:{id:e},async:!1,xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?t=e.data:alert("获取购物车商品失败，原因是"+e.data.errMsg)},error:function(e){alert("获取购物车商品失败，原因是"+e.responseText)}}),t}function t(e){if(null!=e){var t=parseFloat($("#cart_total").html());t+=parseFloat($("#totalPrice_"+e).html()),$("#cart_total").html(t.toFixed(2));var a=parseInt($("#cart_num").html());a+=parseInt($("#amount_"+e).val()),$("#cart_num").html(a),r()}}function a(e){if(null!=e){var t=parseFloat($("#cart_total").html());t-=parseFloat($("#totalPrice_"+e).html()),$("#cart_total").html(t.toFixed(2));var a=parseInt($("#cart_num").html());a-=parseInt($("#amount_"+e).val()),$("#cart_num").html(a),r()}}function r(){var e=!0;$("input:checkbox").each((function(){$(this).is($("#select_all"))||$(this).is(":checked")||(e=!1)})),e?$("#select_all").prop("checked",!0):$("#select_all").prop("checked",!1)}$.ajax({type:"GET",url:host+"/cart/list",xhrFields:{withCredentials:!0},success:function(r){"success"==r.status?function(r){for(var s=r.length,n=0;n<s;n++){var i=r[n],l=e(i.itemId),o="";o+='<ul class="cart_list_td clearfix">       <li class="col01">',1==i.status?o+='<input type="checkbox" name="" id="check_'+i.id+'" data-id="'+i.id+'">':o+="已失效",o+='</li>       <li class="col02"><img src="'+l.imgUrl+'"></li>       <li class="col03">'+l.title+"<br><em>"+l.price.toFixed(2)+'元</em></li>       <li class="col04">1件</li>       <li class="col05"  id="price_'+i.id+'" data-price="'+i.price+'">'+i.price.toFixed(2)+'元</li>       <li class="col06">',1==i.status?o+='          <div class="num_add">               <a href="#" class="add fl" id="add_'+i.id+'" data-id="'+i.id+'">+</a>               <input type="text" class="num_show fl" value="'+i.amount+'" id="amount_'+i.id+'">               <a href="#" class="minus fl" id="minus_'+i.id+'" data-id="'+i.id+'">-</a>          </div>':o+="已失效",o+='       </li>       <li class="col07" id="totalPrice_'+i.id+'">'+i.totalPrice.toFixed(2)+'元</li>       <li class="col08"><a href="#" id="delete_'+i.id+'" data-id="'+i.id+'">删除</a></li></ul>',$("#cart_list").append(o),$("#check_"+i.id).on("click",(function(){var e=$(this).data("id");$(this).is(":checked")?t(e):a(e)})),$("#add_"+i.id).on("click",(function(){var e=$(this).data("id"),t=parseInt($("#amount_"+e).val());if(t<99){var a=t+1;$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/cart/update",data:{id:e,amount:a},xhrFields:{withCredentials:!0},success:function(t){if("success"==t.status){$("#amount_"+e).val(a);var r=100*parseFloat($("#price_"+e).data("price"))*a/100;$("#totalPrice_"+e).html(r.toFixed(2)+"元")}else alert("增加数量失败，原因是"+t.data.errMsg)},error:function(e){alert("增加数量失败，原因是"+e.responseText)}})}else alert("最多一次购买99件商品")})),$("#minus_"+i.id).on("click",(function(){var e=$(this).data("id"),t=parseInt($("#amount_"+e).val());if(t>1){var a=t-1;$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/cart/update",data:{id:e,amount:a},xhrFields:{withCredentials:!0},success:function(t){if("success"==t.status){$("#amount_"+e).val(a);var r=100*parseFloat($("#price_"+e).data("price"))*a/100;$("#totalPrice_"+e).html(r.toFixed(2)+"元")}else alert("减少数量失败，原因是"+t.data.errMsg)},error:function(e){alert("减少数量失败，原因是"+e.responseText)}})}else alert("至少购买1件商品")})),$("#delete_"+i.id).on("click",(function(){var e=$(this).data("id");$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/cart/delete",data:{id:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?window.location.reload():alert("删除失败，原因是"+e.data.errMsg)},error:function(e){alert("删除失败，原因是"+e.responseText)}})}))}$("#cart_list").find("*").trigger("create")}(r.data):(alert("获取购物车商品失败，原因是"+r.data.errMsg),20003==r.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("获取购物车商品失败，原因是"+e.responseText)}}),$("#select_all").on("click",(function(){$(this).is(":checked")?$("input:checkbox").each((function(){$(this).is(":checked")||($(this).prop("checked",!0),t($(this).data("id")))})):$("input:checkbox").each((function(){$(this).is(":checked")&&($(this).prop("checked",!1),a($(this).data("id")))}))})),$("#settle").on("click",(function(){var e="";$("input:checkbox").each((function(){if(!$(this).is($("#select_all"))&&$(this).is(":checked")){var t=$(this).data("id");""==e||(e+=","),e+=t}})),window.location.href="cart-order.html?id-build="+e}))})),$((function(){var e,t,a=(e=new RegExp("(^|&)id=([^&]*)(&|$)"),null!=(t=window.location.search.substr(1).match(e))?decodeURI(t[2]):null),r=[],s=[],n=[];$.ajax({type:"GET",url:host+"/address/list",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(n=e.data,function(){if(null==n)$("#address_list").append("<dd>请编辑收货地址</dd>");else for(var e=0;e<n.length;e++){var t="",a=n[e];t+='<dd><input type="radio" name="address" value="'+a.id+'"',1==a.status&&(t+=" checked "),t+=">"+a.address+" （"+a.addresseeName+" 收） "+a.encrptTelphone+"</dd>",$("#address_list").append(t)}}()):(alert("加载地址信息失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("加载地址信息失败，原因是"+e.responseText)}}),$.ajax({type:"GET",url:host+"/order/getbyid",data:{id:a},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(s=e.data,$.ajax({type:"GET",url:host+"/item/get",data:{id:s.itemId},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(r=e.data,function(){var e=0,t=0;if(null!=s){var a="";e+=s.amount,t+=s.orderPrice,a+='<ul class="goods_list_td clearfix">\n                <li class="col01">1</li>\n                <li class="col02"><img src="'+r.imgUrl+'"></li>\n                <li class="col03">'+r.title+'</li>\n                <li class="col04">一件</li>\n                <li class="col05">'+r.price+'</li>\n                <li class="col06">'+s.amount+'</li>\n                <li class="col07">'+s.orderPrice+"</li>\t\n           </ul>",$("#order_list").append(a),$("#amount").html(e),$(".total").html(t.toFixed(2)+"元"),$("#order_btn").on("click",(function(){var e=$('input[name="pay_style"]:checked').val(),t=$('input[name="address"]:checked').val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/order/complete",data:{id:s.id,paymentMethod:e,addressId:t},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("提交订单成功"),window.location.href="user_center_order.html"):(alert("提交订单失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"),window.location.href="user_center_order.html")},error:function(e){alert("提交订单失败，原因是"+e.responseText),window.location.href="user_center_order.html"}})}))}}()):alert("获取商品信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品信息失败，原因是"+e.responseText)}})):(alert("加载订单失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("加载订单失败，原因是"+e.responseText)}})})),(()=>{var e=[],t=[];const a=["卧室","餐厅","客厅","书房","墙纸","家装风格"];jQuery(document).ready((function(){var r,s;$.ajax({type:"GET",url:host+"/item/get",data:{id:("id",r=new RegExp("(^|&)id=([^&]*)(&|$)"),s=window.location.search.substr(1).match(r),null!=s?decodeURI(s[2]):null)},xhrFields:{withCredentials:!0},success:function(t){"success"==t.status?(e=t.data,function(t){$("#storeName").text(e.storeName),$("#title").text(e.storeName+e.title),$("#description").text(e.description),$("#stock").text(e.stock),$("#price").text(e.price.toFixed(2)),$("#imgUrl").attr("src",e.imgUrl),$("#sales").text(e.sales);var r=e.price*t;$("#total_price").text(r.toFixed(2)),$("#sort").text(a[e.sort-1])}(parseInt($("#amount").val()))):alert("获取信息失败，原因是"+t.data.errMsg)},error:function(e){alert("获取信息失败，原因是"+e.responseText)}}),$("#add_amount").on("click",(function(){var e=parseInt($("#amount").val()),t=parseFloat($("#price").text());e++,$("#amount").val(e);var a=100*t*e/100;$("#total_price").text(a.toFixed(2)+"元")})),$("#minus_amount").on("click",(function(){var e=parseInt($("#amount").val()),t=parseFloat($("#price").text());if(1!=e){e--,$("#amount").val(e);var a=t*e;$("#total_price").text(a.toFixed(2)+"元")}else alert("数量不能小于1")})),$("#buy_now").on("click",(function(){var t=parseInt($("#amount").val());window.location.href="item-order.html?amount="+t+"&itemId="+e.id})),$("#add_cart").on("click",(function(){var t=$("#add_cart").offset().top,a=$("#add_cart").offset().left,r=$("#show_count").offset().top,s=$("#show_count").offset().left,n=parseInt($("#amount").val());$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/cart/add",data:{itemId:e.id,amount:n},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?function(e,t,a,r){$(".add_jump").css({left:t+80,top:e+10,display:"block"}),$(".add_jump").stop().animate({left:r+7,top:a+7},"fast",(function(){$(".add_jump").fadeOut("fast",(function(){getCartNum()}))}))}(t,a,r,s):(alert("添加失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("添加失败，原因是"+e.responseText)}})})),$("#get_items").on("click",(function(){if("商品介绍"==$(".detail_tab").children("li.active").html()){$("#get_items").addClass("active"),$("#get_detail").removeClass("active"),$("#detail_content").hide(),$("#items_content").show();var e=$("#storeName").html();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/listbystorename",data:{storeName:e,page:1},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(t=e.data,function(){if(null!=t)for(var e=t.length,a=0;a<e;a++){var r=t[a];$("#item_"+a).show(),$("#item_"+a).children("a").children("img").attr("src",r.imgUrl),$("#item_"+a).children("h4").children("a").html(r.title),$("#item_"+a).find("span.prize").html("￥ "+r.price.toFixed(2)),$("#item_"+a).find("span.unit").html("/一件"),$("#item_"+a).attr("data-id",r.id),$("#item_"+a).on("click",(function(){window.location.href="detail.html?id="+$(this).data("id")}))}}()):alert("获取本店精选失败，原因是"+e.data.errMsg)},error:function(e){alert("获取本店精选失败，原因是"+e.responseText)}})}})),$("#get_detail").on("click",(function(){"本店精选"==$(".detail_tab").children("li.active").html()&&($("#get_detail").addClass("active"),$("#get_items").removeClass("active"),$("#items_content").hide(),$("#detail_content").show())}))}))})(),document.onkeydown=function(e){var t=(e=window.event||e).keyCode;return 1==e.ctrlKey&&82==t||116==t||1==e.ctrlKey&&116==t||114==t?(e.keyCode=0,alert("当前页面不能刷新！"),e.returnValue=!1,e.cancelBubble=!0,!1):8==t?(alert("不能返回或后退！"),e.keyCode=0,e.returnValue=!1,!1):e.ctrlKey&&78==t||122==t||e.shiftKey&&121==t||e.ctrlKey&&121==t?(e.keyCode=0,e.returnValue=!1,e.cancelBubble=!0,!1):e.altKey&&115==t?(window.showModelessDialog("about:blank","","dialogWidth:1px;dialogheight:1px"),e.keyCode=0,e.returnValue=!1,e.cancelBubble=!0,!1):!e.altKey||37!=t&&39!=t?void 0:(alert("不准你使用ALT+方向键前进或后退网页！"),e.keyCode=0,e.returnValue=!1,e.cancelBubble=!0,!1)},document.oncontextmenu=function(e){window.event&&(e=window.event);try{var t=e.srcElement;return"INPUT"==t.tagName&&"text"==t.type.toLowerCase()||"TEXTAREA"==t.tagName}catch(e){return!1}},$((function(){var e=!1,t=!1;function a(){var t=$("#tel").val();/^1[3456789]\d{9}$/.test(t)?($("#tel").next().next().hide(),e=!1):($("#tel").next().next().html("请输入正确的国内手机号"),$("#tel").next().next().show(),e=!0)}function r(){4!=$("#check").val().length?($("#check").next().html("请输入4位数的验证码"),$("#check").next().show(),t=!0):($("#check").next().hide(),t=!1)}$("#tel").blur((function(){a()})),$("#check").blur((function(){r()})),$("#get_otpCode").on("click",(function(){if(a(),0==e){var t=$("#tel").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/forgot",data:{telphone:t},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?alert("验证码发送成功"):alert("验证码发送失败，原因是"+e.data.errMsg)},error:function(e){alert("验证码发送失败，原因是"+e.responseText)}})}})),$("#findpwd_sub").on("click",(function(){if(a(),r(),0!=e||0!=t)return!1;var s=$("#tel").val(),n=$("#check").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/check",data:{telphone:s,otpCode:n},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?window.location.href="skip-1-reset.html":10001==e.data.errCode?window.location.href="skip-3.html":alert("验证失败，原因是"+e.data.errMsg)},error:function(e){alert("验证失败，原因是"+e.responseText)}})}))})),jQuery(document).ready((function(){$.ajax({type:"GET",url:host+"/user/get",xhrFields:{withCredentials:!0},success:function(e){var t;"success"==e.status?(t=e.data.name,$(".login_info").html("欢迎您：<em>"+t+"</em>"),$(".login_info").show(),$(".login_btn").hide()):($(".login_info").hide(),$(".login_btn").show())},error:function(e){$(".login_info").hide(),$(".login_btn").show()}})})),$((function(){$("#file").change((function(){var e=$("#file")[0].files;if(0!=e.length){var t=$("#file")[0].value;if(t){var a=e[0],r=t.slice(t.indexOf(".")),s=a.size;if(-1==[".jpg",".png"].indexOf(r))return void alert("仅支持jpg与png图片！");if(s>1048576)return void alert("文件大小不能超过1M！");var n=new FileReader;n.readAsDataURL(a),n.onload=function(t){var a=t.target.result,r=new Image;r.src=a,r.onload=function(){var t=r.width,a=r.height;if(t<=500&&a<=500){var s=new FormData;s.append("file",e[0]),$.ajax({type:"POST",url:host+"/item/single",data:s,xhrFields:{withCredentials:!0},cache:!1,processData:!1,contentType:!1,success:function(e){"success"==e.status?($("#imgUrl").val(e.data),$("#upload_img").attr("src",e.data)):alert("上传失败，原因是"+e.data.errMsg)},error:function(e){alert("上传失败，原因是"+e.responseText)}})}else alert("图片尺寸不大于：500*500！")}}}}else alert("请选择图片上传")}))})),(()=>{const e=["卧室","餐厅","客厅","书房","墙纸","家装风格"];function t(a){var r=[];$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/list",data:{sort:a,page:1},xhrFields:{withCredentials:!0},success:function(s){"success"==s.status?(r=s.data,function(e,t){for(var a=t.length,r=0;r<4&&r<a;r++){var s=t[r];$("#goods_title_f"+e+"_"+r).parent().attr({"data-id":s.id,id:"itemDetail"+s.id}),$("#goods_title_f"+e+"_"+r).text(s.title),$("#goods_img_f"+e+"_"+r).attr("src",s.imgUrl),$("#goods_img_f"+e+"_"+r).parent("a").attr("href","detail.html?id="+s.id),$("#goods_price_f"+e+"_"+r).text("￥ "+s.price.toFixed(2)),$("#itemDetail"+s.id).on("click",(function(){window.location.href="detail.html?id="+$(this).data("id")}))}}(a,r),a<=5&&t(a+1)):(alert("获取"+e[a-1]+"分类列表失败，原因是"+s.data.errMsg),a<=5&&t(a+1))},error:function(r){alert("获取"+e[a-1]+"分类列表失败，原因是"+r.responseText),a<=5&&t(a+1)}})}jQuery(document).ready((function(){t(1),function(){for(var e=1;e<=6;e++)$("#get_more_"+e).attr({"data-id":e}),$("#get_more_"+e).on("click",(function(){window.location.href="list.html?sort="+$(this).data("id")}))}()}))})(),$((function(){function e(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?decodeURI(a[2]):null}var t=e("amount"),a=e("itemId"),r=[],s=[],n=[];$.ajax({type:"GET",url:host+"/address/list",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(n=e.data,function(){if(null==n)$("#address_list").append("<dd>请编辑收货地址</dd>");else for(var e=0;e<n.length;e++){var t="",a=n[e];t+='<dd><input type="radio" name="address" value="'+a.id+'"',1==a.status&&(t+=" checked "),t+=">"+a.address+" （"+a.addresseeName+" 收） "+a.encrptTelphone+"</dd>",$("#address_list").append(t)}}()):(alert("加载地址信息失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("加载地址信息失败，原因是"+e.responseText)}}),$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/order/create",data:{itemId:a,amount:t},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(s=e.data,$.ajax({type:"GET",url:host+"/item/get",data:{id:a},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(r=e.data,function(){var e=0,t=0;if(null!=s){var a="";e+=s.amount,t+=s.orderPrice,a+='<ul class="goods_list_td clearfix">\n                <li class="col01">1</li>\n                <li class="col02"><img src="'+r.imgUrl+'"></li>\n                <li class="col03">'+r.title+'</li>\n                <li class="col04">一件</li>\n                <li class="col05">'+r.price+'</li>\n                <li class="col06">'+s.amount+'</li>\n                <li class="col07">'+s.orderPrice+"</li>\t\n           </ul>",$("#order_list").append(a),$("#amount").html(e),$(".total").html(t.toFixed(2)+"元"),$("#order_btn").on("click",(function(){var e=$('input[name="pay_style"]:checked').val(),t=$('input[name="address"]:checked').val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/order/complete",data:{id:s.id,paymentMethod:e,addressId:t},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("提交订单成功"),window.location.href="user_center_order.html"):(alert("提交订单失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"),window.location.href="user_center_order.html")},error:function(e){alert("提交订单失败，原因是"+e.responseText),window.location.href="user_center_order.html"}})}))}}()):alert("获取商品信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品信息失败，原因是"+e.responseText)}})):(alert("创建订单失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("创建订单失败，原因是"+e.responseText)}})})),(()=>{var e=1,t=1;const a=["卧室","餐厅","客厅","书房","墙纸","家装风格"];function r(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?decodeURI(a[2]):null}function s(){$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/count",data:{sort:r("sort")},xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var a=e.data;0!=a&&(t=(a/10+1).toFixed(0)),function(){if(t<=6)for(var e=2;e<=t;e++){var a=e-1;$("#page"+a).after('<a id="page'+e+'" href="#">'+e+"</a>")}else{for($("#page1").after('<a id="page2" href="#">2</a>'),e=3;e<=5;e++)a=e-1,$("#page"+a).after('<a id="page'+e+'" href="#">.</a>');$("#page5").after('<a id="page6" href="#">'+t+"</a>")}}()}else alert("获取商品数量失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品数量失败，原因是"+e.responseText)}})}function n(){if(parseInt($(".pagenation").children(".active").html())!=e)switch($(".pagenation").children(".active").removeClass("active"),e){case 1:case 2:$("#page"+e).addClass("active");break;case 3:$("#page"+e).html("3"),$("#page4").html("."),$("#page"+e).addClass("active");break;case t-1:$("#page5").html(t-1),$("#page5").addClass("active");break;case t-0:$("#page6").addClass("active");break;default:$("#page3").html("."),$("#page5").html("."),$("#page4").html(e),$("#page4").addClass("active")}}function i(){$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/list",data:{sort:r("sort"),page:e},xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var t=e.data;s(),function(e){const t=e.length;$(".goods_type_list").children("li").hide();for(var a=0;a<10&&a<t;a++){var r=e[a];$(".pagenation").show(),$("#item_"+a).show(),$("#item_"+a).attr({"data-id":r.id}),$("#item_"+a).children("a").children("img").attr("src",r.imgUrl),$("#item_"+a).children("h4").children("a").html(r.title),$("#item_"+a).find("span.prize").html("￥ "+r.price.toFixed(2)),$("#item_"+a).find("span.unit").html("/一件"),$("#item_"+a).on("click",(function(){window.location.href="detail.html?id="+$(this).data("id")}))}}(t)}else alert("获取商品列表失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品列表失败，原因是"+e.responseText)}})}jQuery(document).ready((function(){s(),i(),$("#sort").text(a[parseInt(r("sort"))-1]),$("#pg_dn").on("click",(function(){e<t&&(e++,i(),n())})),$("#pg_up").on("click",(function(){e>1&&(e--,i(),n())}))}))})(),(()=>{var e=!1,t=!1;function a(){var t=$("#user_account").val();null==t||""==t?(e=!0,$(".user_error").show()):(e=!1,$(".user_error").hide())}function r(){var e=$("#user_password").val();null==e||""==e?(t=!0,$(".pwd_error").show()):(t=!1,$(".pwd_error").hide())}jQuery(document).ready((function(){$("#user_account").blur((function(){a()})),$("#user_password").blur((function(){r()})),$("#login_btn").on("click",(function(){if(a(),r(),0==e&&0==t){var s=$("#user_account").val(),n=$("#user_password").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/store/login",data:{telphone:s,password:n},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("登录成功"),window.location.href="store_center_info.html"):alert("登录失败，原因是"+e.data.errMsg)},error:function(e){alert("登录失败，原因是"+e.responseText)}})}}))}))})(),(()=>{var e=!1,t=!1,a=!1;function r(){var e=$("#user_account").val();null==e||""==e?(t=!0,$(".user_error").show()):(t=!1,$(".user_error").hide())}function s(){var e=$("#user_password").val();null==e||""==e?(a=!0,$(".pwd_error").show()):(a=!1,$(".pwd_error").hide())}jQuery(document).ready((function(){$("#user_account").blur((function(){r($(this).val())})),$("#user_password").blur((function(){s($(this).val())})),$("#login_btn").on("click",(function(){if(r(),s(),e=!!/^[a-z0-9][\w\.\-]*@[a-z0-9\-]+(\.[a-z]{2,5}){1,2}$/.test($("#user_account").val()),0==t&&0==a){var n=$("#user_account").val(),i=$("#user_password").val();1==e?$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/loginbyemail",data:{email:n,password:i},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("登录成功"),window.location.href="index.html"):alert("登录失败，原因是"+e.data.errMsg)},error:function(e){alert("登录失败，原因是"+e.responseText)}}):$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/loginbytelphone",data:{telphone:n,password:i},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("登录成功"),window.location.href="index.html"):alert("登录失败，原因是"+e.data.errMsg)},error:function(e){alert("登录失败，原因是"+e.responseText)}})}}))}))})(),jQuery(document).ready((function(){$.ajax({type:"GET",url:host+"/cart/getnum",xhrFields:{withCredentials:!0},success:function(e){var t;"success"==e.status?(t=e.data,$(".goods_count").html(t),$(".goods_count").show()):$(".goods_count").hide()},error:function(e){$(".goods_count").hide()}})})),jQuery(document).ready((function(){$.ajax({type:"GET",url:host+"/item/listbyupdatetime",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?function(e){for(var t=0;t<2;t++){var a=e[t];$("#goods_price_"+t).parent().attr({"data-id":a.id,id:"itemDetail"+a.id}),$("#goods_title_"+t).text(a.title),$("#goods_img_"+t).attr("src",a.imgUrl),$("#goods_price_"+t).text("￥ "+a.price.toFixed(2)),$("#itemDetail"+a.id).on("click",(function(){window.location.href="detail.html?id="+$(this).data("id")}))}}(e.data):alert("获取新品推荐失败，原因是"+e.data.errMsg)},error:function(e){alert("获取新品推荐失败，原因是"+e.responseText)}})})),$((function(){var e=!1,t=!1,a=!1,r=!1,s=!1,n=!1;function i(){var t=$("#user_name").val().length;t<2||t>10?($("#user_name").next().html("请输入2-10个字符的商铺名"),$("#user_name").next().show(),e=!0):($("#user_name").next().hide(),e=!1)}function l(){4!=$("#check").val().length?($("#check").next().html("请输入4位数的验证码"),$("#check").next().show(),s=!0):($("#check").next().hide(),s=!1)}function o(){var e=$("#tel").val();/^1[3456789]\d{9}$/.test(e)?($("#tel").next().next().hide(),t=!1):($("#tel").next().next().html("请输入正确的国内手机号"),$("#tel").next().next().show(),t=!0)}function c(){var e=$("#pwd").val().length;e<8||e>20?($("#pwd").next().html("密码最少8位，最长20位"),$("#pwd").next().show(),a=!0):($("#pwd").next().hide(),a=!1)}function d(){$("#pwd").val()!=$("#cpwd").val()?($("#cpwd").next().html("两次输入的密码不一致"),$("#cpwd").next().show(),r=!0):($("#cpwd").next().hide(),r=!1)}function u(){$("#address").val().length<=3?($("#address").next().html("请输入详细的地址"),$("#address").next().show(),n=!0):($("#address").next().hide(),n=!1)}$("#user_name").blur((function(){i()})),$("#tel").blur((function(){o()})),$("#pwd").blur((function(){c()})),$("#cpwd").blur((function(){d()})),$("#check").blur((function(){l()})),$("#address").blur((function(){u()})),$("#allow").click((function(){$(this).is(":checked")?(s=!1,$(this).siblings("span").hide()):(s=!0,$(this).siblings("span").html("请勾选同意"),$(this).siblings("span").show())})),$("#get_otpCode").on("click",(function(){if(o(),0==t){var e=$("#tel").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/store/getotp",data:{telphone:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?alert("验证码发送成功，可惜只发给了管理员（我是不会告诉你管理员穷到买不起短信服务的T_T），快找管理员要验证码吧"):alert("验证码发送失败，原因是"+e.data.errMsg)},error:function(e){alert("验证码发送失败，原因是"+e.responseText)}})}})),$("#register_sub").on("click",(function(){if(i(),o(),c(),d(),l(),u(),0!=e||0!=a||0!=r||0!=s||0!=t||0!=s||0!=n)return!1;var h=$("#user_name").val(),p=$("#tel").val(),f=$("#check").val(),m=$("#pwd").val(),g=$("#address").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/store/register",data:{telphone:p,otpCode:f,storeName:h,address:g,password:m},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("注册成功"),window.location.href="login-e.html"):alert("注册失败，原因是"+e.data.errMsg)},error:function(e){alert("注册失败，原因是"+e.responseText)}})}))})),$((function(){var e=!1,t=!1,a=!1,r=!1,s=!1,n=!1,i=!1;function l(){var t=$("#user_name").val().length;t<3||t>20?($("#user_name").next().html("请输入3-20个字符的用户名"),$("#user_name").next().show(),e=!0):($("#user_name").next().hide(),e=!1)}function o(){var e=parseInt($("#age").val());e<0||e>150?($("#age").next().html("年龄请输入0~150的数字"),$("#age").next().show(),i=!0):($("#age").next().hide(),i=!1)}function c(){4!=$("#check").val().length?($("#check").next().html("请输入4位数的验证码"),$("#check").next().show(),n=!0):($("#check").next().hide(),n=!1)}function d(){var e=$("#tel").val();/^1[3456789]\d{9}$/.test(e)?($("#tel").next().next().hide(),t=!1):($("#tel").next().next().html("请输入正确的国内手机号"),$("#tel").next().next().show(),t=!0)}function u(){var e=$("#pwd").val().length;e<8||e>20?($("#pwd").next().html("密码最少8位，最长20位"),$("#pwd").next().show(),a=!0):($("#pwd").next().hide(),a=!1)}function h(){$("#pwd").val()!=$("#cpwd").val()?($("#cpwd").next().html("两次输入的密码不一致"),$("#cpwd").next().show(),r=!0):($("#cpwd").next().hide(),r=!1)}function p(){/^[a-z0-9][\w\.\-]*@[a-z0-9\-]+(\.[a-z]{2,5}){1,2}$/.test($("#email").val())?($("#email").next().hide(),s=!1):($("#email").next().html("你输入的邮箱格式不正确"),$("#email").next().show(),r=!0)}$("#user_name").blur((function(){l()})),$("#tel").blur((function(){d()})),$("#pwd").blur((function(){u()})),$("#cpwd").blur((function(){h()})),$("#email").blur((function(){p()})),$("#age").blur((function(){o()})),$("#check").blur((function(){c()})),$("#allow").click((function(){$(this).is(":checked")?(n=!1,$(this).siblings("span").hide()):(n=!0,$(this).siblings("span").html("请勾选同意"),$(this).siblings("span").show())})),$("#get_otpCode").on("click",(function(){if(d(),0==t){var e=$("#tel").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/getotp",data:{telphone:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?alert("验证码发送成功，可惜只发给了管理员（我是不会告诉你管理员穷到买不起短信服务的T_T），快找管理员要验证码吧"):alert("验证码发送失败，原因是"+e.data.errMsg)},error:function(e){alert("验证码发送失败，原因是"+e.responseText)}})}})),$("#register_sub").on("click",(function(){if(l(),d(),u(),h(),o(),p(),c(),0!=e||0!=a||0!=r||0!=s||0!=n||0!=t||0!=i||0!=n)return!1;var f=$("#user_name").val(),m=$("#tel").val(),g=$("#check").val(),w=$("#email").val(),x=$("#pwd").val(),_=parseInt($("#age").val()),v=$("#gender option:selected").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/register",data:{telphone:m,otpCode:g,name:f,gender:v,age:_,email:w,password:x},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("注册成功"),window.location.href="login.html"):alert("注册失败，原因是"+e.data.errMsg)},error:function(e){alert("注册失败，原因是"+e.responseText)}})}))})),$((function(){var e=!1,t=!1;function a(){var t=$("#pwd").val().length;t<8||t>20?($("#pwd").next().html("密码最少8位，最长20位"),$("#pwd").next().show(),e=!0):($("#pwd").next().hide(),e=!1)}function r(){$("#pwd").val()!=$("#cpwd").val()?($("#cpwd").next().html("两次输入的密码不一致"),$("#cpwd").next().show(),t=!0):($("#cpwd").next().hide(),t=!1)}$("#pwd").blur((function(){a()})),$("#cpwd").blur((function(){r()})),$("#reset_sub").on("click",(function(){if(a(),r(),0!=e||0!=t)return!1;var s=$("#pwd").val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/reset",data:{password:s},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?window.location.href="skip-2.html":(alert("新密码设置失败，原因是"+e.data.errMsg),20005==e.data.errCode?window.location.href="findpwd.html":10001==e.data.errCode&&($("#pwd").val(""),$("#cpwd").val("")))},error:function(e){alert("新密码设置失败，原因是"+e.responseText)}})}))})),jQuery(document).ready((function(){$(".input_btn").on("click",(function(){var e=$("#search").val();null==e||""==e?alert("关键词不能为空"):window.location.href="searchlist.html?keyword="+e}))})),(()=>{var e=1,t=1;function a(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?decodeURI(a[2]):null}function r(){$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/searchresult",data:{keyWord:a("keyword")},xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var a=e.data;0!=a&&(t=(a/10+1).toFixed(0)),function(){if(t<=6)for(var e=2;e<=t;e++){var a=e-1;$("#page"+a).after('<a id="page'+e+'" href="#">'+e+"</a>")}else{for($("#page1").after('<a id="page2" href="#">2</a>'),e=3;e<=5;e++)a=e-1,$("#page"+a).after('<a id="page'+e+'" href="#">.</a>');$("#page5").after('<a id="page6" href="#">'+t+"</a>")}}()}},error:function(e){alert("获取商品数量失败，原因是"+e.responseText)}})}function s(){if(parseInt($(".pagenation").children(".active").html())!=e)switch($(".pagenation").children(".active").removeClass("active"),e){case 1:case 2:$("#page"+e).addClass("active");break;case 3:$("#page"+e).html("3"),$("#page4").html("."),$("#page"+e).addClass("active");break;case t-1:$("#page5").html(t-1),$("#page5").addClass("active");break;case t-0:$("#page6").addClass("active");break;default:$("#page3").html("."),$("#page5").html("."),$("#page4").html(e),$("#page4").addClass("active")}}function n(){$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/search",data:{keyWord:a("keyword"),page:e},xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var t=e.data;r(),function(e){const t=e.length;$(".goods_type_list").children("li").hide();for(var a=0;a<10&&a<t;a++){var r=e[a];$(".pagenation").show(),$("#item_"+a).show(),$("#item_"+a).attr({"data-id":r.id}),$("#item_"+a).children("a").children("img").attr("src",r.imgUrl),$("#item_"+a).children("h4").children("a").html(r.title),$("#item_"+a).find("span.prize").html("￥ "+r.price.toFixed(2)),$("#item_"+a).find("span.unit").html("/一件"),$("#item_"+a).on("click",(function(){window.location.href="detail.html?id="+$(this).data("id")}))}}(t)}else alert("搜素失败，原因是"+e.data.errMsg)},error:function(e){alert("搜索失败，原因是"+e.responseText)}})}jQuery(document).ready((function(){$("#search_title").html("搜索："+a("keyword")),r(),n(),$("#pg_dn").on("click",(function(){e<t&&(e++,n(),s())})),$("#pg_up").on("click",(function(){e>1&&(e--,n(),s())}))}))})(),$((function(){var e=$(".slide_pics li"),t=e.length,a=0,r=0,s=$(".prev"),n=$(".next"),i=!1,l=null;function o(){a++,c(),$points.eq(a).addClass("active").siblings().removeClass("active")}function c(){return i=!0,a<0?(a=t-1,r=0,e.eq(a).css({left:-760}),e.eq(a).animate({left:0},800,"easeOutExpo"),e.eq(r).animate({left:760},800,"easeOutExpo",(function(){i=!1})),void(r=a)):a>t-1?(a=0,r=t-1,e.eq(a).css({left:760}),e.eq(a).animate({left:0},800,"easeOutExpo"),e.eq(r).animate({left:-760},800,"easeOutExpo",(function(){i=!1})),void(r=a)):void(r<a?(e.eq(a).css({left:760}),e.eq(r).animate({left:-760},800,"easeOutExpo"),e.eq(a).animate({left:0},800,"easeOutExpo",(function(){i=!1})),r=a):(e.eq(a).css({left:-760}),e.eq(r).animate({left:760},800,"easeOutExpo"),e.eq(a).animate({left:0},800,"easeOutExpo",(function(){i=!1})),r=a))}e.not(":first").css({left:760}),e.each((function(e,t){var a=$("<li>");0==e&&a.addClass("active"),a.appendTo($(".points"))})),$points=$(".points li"),l=setInterval(o,4e3),$(".slide").mouseenter((function(){clearInterval(l)})),$(".slide").mouseleave((function(){l=setInterval(o,4e3)})),$points.click((function(e){i||(a=$(this).index())!=r&&($(this).addClass("active").siblings().removeClass("active"),c())})),s.click((function(){i||(a--,c(),$points.eq(a).addClass("active").siblings().removeClass("active"))})),n.click((function(){i||(a++,c(),$points.eq(a).addClass("active").siblings().removeClass("active"))}))})),$((function(){$(".info_submit").on("click",(function(){var e=$("#title").val(),t=$("#description").val(),a=$("#sort option:selected").val(),r=$("#price").val(),s=$("#stock").val(),n=$("#imgUrl").val();null==e||""==e?alert("商品名不能为空"):null==t||""==t?alert("商品描述不能为空"):null==r||""==r?alert("价格不能为空"):null==s||""==s?alert("库存不能为空"):null==n||""==n?alert("图片地址不能为空"):$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/create",data:{title:e,description:t,sort:a,price:r,stock:s,imgUrl:n},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("添加成功"),window.location.href="store_center_all.html"):alert("添加失败，原因是"+e.data.errMsg)},error:function(e){alert("添加失败，原因是"+e.responseText)}})}))})),(()=>{var e=1,t=1;function a(){if(parseInt($(".pagenation").children(".active").html())!=e)switch($(".pagenation").children(".active").removeClass("active"),e){case 1:case 2:$("#page"+e).addClass("active");break;case 3:$("#page"+e).html("3"),$("#page4").html("."),$("#page"+e).addClass("active");break;case t-1:$("#page5").html(t-1),$("#page5").addClass("active");break;case t-0:$("#page6").addClass("active");break;default:$("#page3").html("."),$("#page5").html("."),$("#page4").html(e),$("#page4").addClass("active")}}function r(){$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/item/storeitemlist",data:{page:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?function(e){const t=e.length;$(".goods_type_list").children("li").hide();for(var a=0;a<10&&a<t;a++){var r=e[a];$(".pagenation").show(),$("#item_"+a).show(),$("#item_"+a).attr({"data-id":r.id}),$("#item_"+a).children("a").children("img").attr("src",r.imgUrl),$("#item_"+a).children("h4").children("a").html(r.title),$("#item_"+a).find("span.prize").html("￥ "+r.price.toFixed(2)),$("#item_"+a).find("span.unit").html("/一件"),$("#item_"+a).on("click",(function(){window.location.href="detail.html?id="+$(this).data("id")}))}}(e.data):alert("获取商品列表失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品列表失败，原因是"+e.responseText)}})}jQuery(document).ready((function(){$.ajax({type:"GET",url:host+"/item/storeitemscount",xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var a=e.data;0!=a&&(t=(a/10+1).toFixed(0)),function(){if(t<=6)for(var e=2;e<=t;e++){var a=e-1;$("#page"+a).after('<a id="page'+e+'" href="#">'+e+"</a>")}else{for($("#page1").after('<a id="page2" href="#">2</a>'),e=3;e<=5;e++)a=e-1,$("#page"+a).after('<a id="page'+e+'" href="#">.</a>');$("#page5").after('<a id="page6" href="#">'+t+"</a>")}}()}else alert("获取商品数量失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品数量失败，原因是"+e.responseText)}}),r(),$("#pg_dn").on("click",(function(){e<t&&(e++,r(),a())})),$("#pg_up").on("click",(function(){e>1&&(e--,r(),a())}))}))})(),$((function(){var e=[];$.ajax({type:"GET",url:host+"/store/get",xhrFields:{withCredentials:!0},success:function(t){var a;"success"==t.status?(a="",a+="<li><span>商铺名：</span>"+(e=t.data).storeName+"</li><li><span>商铺地址：</span>"+e.address+"</li><li><span>联系方式：</span>"+e.telphone+"</li>",$("#store_info").append(a),$("#create_time").html("<span>注册时间：</span>"+new Date(e.createTime).toLocaleDateString())):alert("获取商铺信息失败，原因是"+t.data.errMsg)},error:function(e){alert("获取商铺信息失败，原因是"+e.responseText)}})})),$((function(){var e=1,t=1,a=[];function r(){if(parseInt($(".pagenation").children(".active").html())!=e)if($(".pagenation").children(".active").removeClass("active"),t>6)switch(e){case 1:case 2:$("#page"+e).addClass("active");break;case 3:$("#page"+e).html("3"),$("#page4").html("."),$("#page"+e).addClass("active");break;case t-1:$("#page5").html(t-1),$("#page5").addClass("active");break;case t-0:$("#page6").addClass("active");break;default:$("#page3").html("."),$("#page5").html("."),$("#page4").html(e),$("#page4").addClass("active")}else $("#page"+e).addClass("active")}function s(){$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/store/getlogistics",data:{page:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(a=e.data,function(){if(null!=a){$(".logistics_list").children("div").hide();for(var e=0;e<a.length;e++){var t=a[e],r=i(t.orderId),o=n(r.itemId),c=l(t.addressId);$("#logistics_"+e).show(),$("#time_"+e).html(new Date(t.createTime).format("yyyy-MM-dd hh:mm:ss")),$("#order_id_"+e).html("订单号："+t.orderId),1==t.status?$("#order_status_"+e).html("未发货"):$("#order_status_"+e).html("已发货"),$("#img_"+e).attr("src",o.imgUrl),$("#title_"+e).html(o.title),$("#amount_"+e).html(r.amount),$("#price_"+e).html(r.itemPrice.toFixed(2)),$("#total_"+e).html(r.orderPrice.toFixed(2)),$("#addressee_"+e).html(c.addresseeName),$("#telphone_"+e).html(c.encrptTelphone),$("#address_"+e).html(c.address),1==t.status?($("#order_status_"+e).html("待发货"),$("#write_info_"+e).show(),$("#send_list_"+e).hide(),$("#write_info_"+e).attr({"data-id":t.id,"data-i":e}),$("#sub_info_"+e).attr({"data-id":t.id,"data-i":e}),$("#get_logistics_"+e).hide(),$("#write_info_"+e).on("click",(function(){$(this).hide();var e=$(this).data("i");$(this).next().show(),$("#sub_info_"+e).on("click",(function(){var e=$(this).data("id"),t=$(this).data("i"),a=$("#company_"+t).val(),r=$("#number_"+t).val();null==a||""==a?$("#company_"+t).attr("placeholder","快递公司不能为空"):null==r||""==r?$("#number_"+t).attr("placeholder","快递单号不能为空"):$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/store/delivery",data:{id:e,company:a,number:r},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?s():alert("提交失败，原因是"+e.data.errMsg)},error:function(e){alert("提交失败，原因是"+e.responseText)}})}))}))):($("#status_"+e).html("运输中"),$("#get_logistics_"+e).show(),$("#write_info_"+e).hide(),$("#send_list_"+e).hide())}}}()):alert("获取订单列表失败，原因是"+e.data.errMsg)},error:function(e){alert("获取订单列表失败，原因是"+e.responseText)}})}function n(e){var t=[];return $.ajax({type:"GET",url:host+"/item/get",data:{id:e},async:!1,xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?t=e.data:alert("获取商品信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品信息失败，原因是"+e.responseText)}}),t}function i(e){var t=[];return $.ajax({type:"GET",url:host+"/order/getbyid",data:{id:e},async:!1,xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?t=e.data:alert("获取订单信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取订单信息失败，原因是"+e.responseText)}}),t}function l(e){var t=[];return $.ajax({type:"GET",url:host+"/address/get",data:{id:e},async:!1,xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?t=e.data:alert("获取地址信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取地址信息失败，原因是"+e.responseText)}}),t}$.ajax({type:"GET",url:host+"/store/getcount",xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var a=e.data;0!=a&&(t=(a/10+1).toFixed(0),function(){if($(".pagenation").show(),t<=6)for(var e=2;e<=t;e++){var a=e-1;$("#page"+a).after('<a id="page'+e+'" href="#">'+e+"</a>")}else{for($("#page1").after('<a id="page2" href="#">2</a>'),e=3;e<=5;e++)a=e-1,$("#page"+a).after('<a id="page'+e+'" href="#">.</a>');$("#page5").after('<a id="page6" href="#">'+t+"</a>")}}())}else alert("获取订单数量失败，原因是"+e.data.errMsg)},error:function(e){alert("获取订单数量失败，原因是"+e.responseText)}}),s(),$("#pg_dn").on("click",(function(){e<t&&(e++,s(),r())})),$("#pg_up").on("click",(function(){e>1&&(e--,s(),r())})),Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}})),$((function(){var e=[];$.ajax({type:"GET",url:host+"/user/get",xhrFields:{withCredentials:!0},success:function(t){"success"==t.status?(e=t.data,$("#name").html("<span>用户名：</span>"+e.name),$("#telphone").html("<span>绑定手机：</span>"+e.telphone),$("#email").html("<span>绑定邮箱：</span>"+e.email),$("#gender").html("<span>性别：</span>"+(1==e.gender?"男":"女")),$("#age").html("<span>年龄：</span>"+e.age)):(alert("获取用户信息失败，原因是"+t.data.errMsg),20003==t.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("获取用户信息失败，原因是"+e.responseText)}}),$("#logout").on("click",(function(){$.ajax({type:"GET",url:host+"/user/logout",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("注销登录成功"),window.location.href="index.html"):(alert("注销登录失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("注销登录失败，原因是"+e.responseText)}})}))})),$((function(){var e=1,t=1,a=[];function r(){if(parseInt($(".pagenation").children(".active").html())!=e)switch($(".pagenation").children(".active").removeClass("active"),e){case 1:case 2:$("#page"+e).addClass("active");break;case 3:$("#page"+e).html("3"),$("#page4").html("."),$("#page"+e).addClass("active");break;case t-1:$("#page5").html(t-1),$("#page5").addClass("active");break;case t-0:$("#page6").addClass("active");break;default:$("#page3").html("."),$("#page5").html("."),$("#page4").html(e),$("#page4").addClass("active")}}function s(){$.ajax({type:"GET",url:host+"/order/list",data:{page:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(a=e.data,function(){if(null!=a){$(".order_list").hide();for(var e=0;e<a.length;e++){var t=a[e],r=n(t.itemId);$("#order_"+e).show(),$("#time_"+e).html(new Date(t.createTime).format("yyyy-MM-dd hh:mm:ss")),$("#order_id_"+e).html(t.id),1==t.status?$("#order_status_"+e).html("未支付"):$("#order_status_"+e).html("已支付"),$("#img_"+e).attr("src",r.imgUrl),$("#title_"+e).html(r.title),$("#amount_"+e).html(t.amount),$("#price_"+e).html(t.itemPrice.toFixed(2)),$("#total_"+e).html(t.orderPrice.toFixed(2)),1==t.status?($("#logistics_status_"+e).html("待付款"),$("#pay_btn_"+e).show(),$("#pay_btn_"+e).attr({"data-id":t.id}),$("#cancel_btn_"+e).show(),$("#cancel_btn_"+e).attr({"data-id":t.id}),$("#send_msg_"+e).hide(),$("#get_logistics_"+e).hide(),$("#pay_btn_"+e).on("click",(function(){var e=$(this).data("id");window.location.href="center-order.html?id="+e})),$("#cancel_btn_"+e).on("click",(function(){var e=$(this).data("id");$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/order/cancel",data:{id:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?window.location.reload():alert("取消订单失败，原因是"+e.data.errMsg)},error:function(e){alert("取消订单失败，原因是"+e.responseText)}})}))):2==t.status?($("#logistics_status_"+e).html("待发货"),$("#send_msg_"+e).show(),$("#pay_btn_"+e).hide(),$("#cancel_btn_"+e).hide(),$("#get_logistics_"+e).hide()):($("#logistics_status_"+e).html("运输中"),$("#get_logistics_"+e).show(),$("#pay_btn_"+e).hide(),$("#cancel_btn_"+e).hide(),$("#send_msg_"+e).hide())}}}()):alert("获取订单列表失败，原因是"+e.data.errMsg)},error:function(e){alert("获取订单列表失败，原因是"+e.responseText)}})}function n(e){var t=[];return $.ajax({type:"GET",url:host+"/item/get",data:{id:e},async:!1,xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?t=e.data:alert("获取商品信息失败，原因是"+e.data.errMsg)},error:function(e){alert("获取商品信息失败，原因是"+e.responseText)}}),t}$.ajax({type:"GET",url:host+"/order/count",xhrFields:{withCredentials:!0},success:function(e){if("success"==e.status){var a=e.data;0!=a&&(t=(a/10+1).toFixed(0),function(){if($(".pagenation").show(),t<=6)for(var e=2;e<=t;e++){var a=e-1;$("#page"+a).after('<a id="page'+e+'" href="#">'+e+"</a>")}else{for($("#page1").after('<a id="page2" href="#">2</a>'),e=3;e<=5;e++)a=e-1,$("#page"+a).after('<a id="page'+e+'" href="#">.</a>');$("#page5").after('<a id="page6" href="#">'+t+"</a>")}}())}else alert("获取订单数量失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html")},error:function(e){alert("获取订单数量失败，原因是"+e.responseText)}}),s(),$("#pg_dn").on("click",(function(){e<t&&(e++,s(),r())})),$("#pg_up").on("click",(function(){e>1&&(e--,s(),r())})),$("#logout").on("click",(function(){$.ajax({type:"GET",url:host+"/user/logout",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("注销登录成功"),window.location.href="index.html"):(alert("注销登录失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("注销登录失败，原因是"+e.responseText)}})})),Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}})),$((function(){var e=[];$.ajax({type:"GET",url:host+"/address/list",xhrFields:{withCredentials:!0},success:function(t){"success"==t.status?(e=t.data,function(){if(null!=e)for(var t=0;t<e.length;t++){var a=e[t],r="";r+="<dd>"+a.address+"  （"+a.addresseeName+" 收） "+a.encrptTelphone+'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio"  id="address_'+a.id+'" name="address" value="'+a.id+'"',1==a.status&&(r+=" checked "),r+=">设为默认 </dd>",$("#address_list").append(r),2==a.status&&$("#address_"+a.id).on("click",(function(){var e=$(this).val();$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/address/set",data:{id:e},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?window.location.reload():alert("设置失败，原因是"+e.data.errMsg)},error:function(e){alert("设置失败，原因是"+e.responseText)}})}))}}()):alert("获取地址列表失败，原因是"+t.data.errMsg)},error:function(e){alert("获取地址列表失败，原因是"+e.responseText)}}),$("#sub_bnt").on("click",(function(){var e=$("#name").val(),t=$("#address").val(),a=$("#postcode").val(),r=$("#telphone").val();null==e||""==e?alert("收件人不能为空"):null==t||""==t?alert("详细地址不能为空"):null==a||""==a?alert("邮编不能为空"):null==r||""==r?alert("手机不能为空"):$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/address/create",data:{addresseeName:e,address:t,postcode:a,addresseeTelphone:r},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("提交成功"),window.location.reload()):alert("提交失败，原因是"+e.data.errMsg)},error:function(e){alert("提交失败，原因是"+e.responseText)}})})),$("#logout").on("click",(function(){$.ajax({type:"GET",url:host+"/user/logout",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("注销登录成功"),window.location.href="index.html"):(alert("注销登录失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("注销登录失败，原因是"+e.responseText)}})}))})),$((function(){var e=[];$.ajax({type:"GET",url:host+"/user/get",xhrFields:{withCredentials:!0},success:function(t){"success"==t.status?(e=t.data,$("#name").val(e.name),$("#telphone").html("<span>绑定手机：</span>"+e.telphone),$("#email").val(e.email),$("#age").val(e.age),$("input:radio[value="+e.gender+"]").attr("checked","true")):alert("获取用户信息失败，原因是"+t.data.errMsg)},error:function(e){alert("获取用户信息失败，原因是"+e.responseText)}}),$("#update").on("click",(function(){var e=$("#name").val(),t=$("#email").val(),a=$("#age").val(),r=$("input:radio:checked").val();null==e||""==e?alert("用户名不能为空"):null==t||""==t?alert("绑定邮箱不能为空"):null==a||""==a?alert("年龄不能为空"):null==r||""==r?alert("性别不能不选"):$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:host+"/user/update",data:{name:e,email:t,age:a,gender:r},xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("添加成功"),window.location.href="user_center_info.html"):alert("添加失败，原因是"+e.data.errMsg)},error:function(e){alert("添加失败，原因是"+e.responseText)}})})),$("#logout").on("click",(function(){$.ajax({type:"GET",url:host+"/user/logout",xhrFields:{withCredentials:!0},success:function(e){"success"==e.status?(alert("注销登录成功"),window.location.href="index.html"):(alert("注销登录失败，原因是"+e.data.errMsg),20003==e.data.errCode&&(window.location.href="login.html"))},error:function(e){alert("注销登录失败，原因是"+e.responseText)}})}))}));